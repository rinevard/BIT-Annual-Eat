# 项目安全性说明

本项目不会把学号写入本地文件或上传到除校园卡官方网站之外的第三方服务器，所有查询都在本地进行，生成的输出文件包括消费明细 CSV、统计图 PNG、HTML 报告，不包含学号。

如果用户不上传报告，无需担心数据泄露。如果用户选择上传报告，上传过程中会传输的数据包括：

1. 按日期聚合后的消费数据 JSON，包含每天的用餐次数、金额和商户名称。由于不包含学号、密码信息，所以无法逆向得知这是谁的消费明细。
2. 学号的哈希值 student_key. 这被用于在服务器端生成唯一但不可逆向推出学号的报告 ID。报告 ID 的生成方法在文末。

需要注意的是，HTML 报告内容本身可能包含个人行为特征（如特定时间段的消费模式、特定商户名称等），这属于间接可识别信息。如果用户不希望任何消费记录离开本机，可以选择不上传，只在本地查看报告。

最后我们看看报告 ID 是如何生成的。首先本地令 `student_key = hash(学号)` 并将 `student_key` 上传到服务器，然后服务端用 `hash(secret:student_key)` 求出 64 位十六进制字符串，再取该哈希的前 8 位作为报告 ID，最终将报告数据存入 `https://r.eatbit.top/r/{id}`. 这里的 secret 是预先随机生成的足够长的字符串，这里的 hash 是 SHA-256。

总之，单凭一个 8 位十六进制的报告 ID 几乎不可能直接倒推出具体学号。当然，如果攻击者事先掌握 secret 的值，可以在本地遍历学号并对比 ID 用来暴力求出学号值，但 secret 仅在服务端配置，不会对外公开，所以可以认为学号是安全的。