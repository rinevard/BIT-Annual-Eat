<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consistent Heavy Slam (Mirrored)</title>
    <style>
        :root {
            --h: 55vh;
            --gap: 20px;
            /* 尺寸定义 */
            --w-main: calc(var(--h) * 4 / 3);
            --w-right: calc(var(--h) * 3 / 4);
            --w-left: 100px;
            /* 运镜偏移量 */
            --pan-offset: calc((var(--w-right) + var(--gap)) * -0.5);
        }

        body {
            margin: 0;
            height: 100vh;
            background-color: #1a1a1a;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Segoe UI', sans-serif;
            perspective: 1000px;
        }

        .camera-rig {
            position: relative;
            width: var(--w-main);
            height: var(--h);
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .camera-rig.pan-right {
            transform: translateX(var(--pan-offset));
        }

        /* === 通用卡片属性 === */
        .card {
            position: absolute;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border-radius: 6px;
            opacity: 0;
            transform: translateZ(2000px);
            pointer-events: none;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
        }

        /* === 主体卡片 === */
        .card.main {
            width: var(--w-main);
            background: #dcdde1;
            opacity: 1;
            transform: translateZ(0);
            pointer-events: auto;
            z-index: 10;
            flex-direction: column;
            gap: 20px;
            border: 1px solid #bdc3c7;
            text-shadow: none;
        }

        /* === 左侧条形 (方向系数: 1) === */
        .card.left {
            --dir: 1;
            /* 关键：正向 */

            width: var(--w-left);
            right: 100%;
            margin-right: var(--gap);
            background: #c0392b;
            color: white;
            writing-mode: vertical-rl;
            text-orientation: upright;
            font-weight: 900;
            font-size: 2.5rem;
            letter-spacing: 0.5rem;
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        /* === 右侧卡片 (方向系数: -1) === */
        .card.right {
            --dir: -1;
            /* 关键：反向 (镜像) */

            width: var(--w-right);
            left: 100%;
            margin-left: var(--gap);
            background: #2980b9;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            border: 3px solid rgba(255, 255, 255, 0.3);
            flex-direction: column;
            text-align: center;
        }

        /* === 按钮样式 === */
        .btn-group {
            display: flex;
            gap: 20px;
        }

        button {
            padding: 15px 30px;
            font-size: 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: transform 0.1s;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 4px 0 rgba(0, 0, 0, 0.2);
            font-family: 'Segoe UI', sans-serif;
        }

        button:active {
            transform: scale(0.95);
            box-shadow: none;
        }

        .btn-left {
            background: #c0392b;
            color: white;
        }

        .btn-right {
            background: #2980b9;
            color: white;
        }

        /* =========================================
           核心动画库：利用 var(--dir) 实现镜像
           ========================================= */

        .anim-slam {
            animation: powerSlam 0.35s ease-out forwards;
        }

        @keyframes powerSlam {
            0% {
                opacity: 0;
                /* 
                   rotateY: 左右翻转方向相反
                   rotateZ: 左右倾斜方向相反
                */
                transform: translateZ(2000px) rotateX(45deg) rotateY(calc(-20deg * var(--dir))) rotateZ(calc(-5deg * var(--dir)));
            }

            85% {
                opacity: 1;
                /* 撞击瞬间：左卡向左歪(-2)，右卡向右歪(+2) */
                transform: translateZ(0) rotateZ(calc(-2deg * var(--dir)));
            }

            90% {
                /* 震颤 */
                transform: translateZ(0) rotateZ(calc(-3deg * var(--dir)));
            }

            100% {
                opacity: 1;
                transform: translateZ(0) rotateZ(calc(-2deg * var(--dir)));
            }
        }

        .anim-exit {
            animation: liftFly 0.5s cubic-bezier(0.5, 0, 0.8, 0.5) forwards;
        }

        @keyframes liftFly {
            0% {
                opacity: 1;
                transform: translateZ(0) rotateZ(calc(-2deg * var(--dir)));
            }

            20% {
                /* 提起：向各自的外侧倾斜 */
                transform: translateZ(50px) rotateX(-10deg) rotateZ(calc(-5deg * var(--dir)));
            }

            100% {
                opacity: 0;
                /* 飞走：左卡往左后飞，右卡往右后飞 */
                transform: translateZ(1500px) rotateX(-30deg) rotateY(calc(20deg * var(--dir)));
            }
        }
    </style>
</head>

<body>

    <div class="camera-rig" id="cameraRig">
        <!-- 左侧 -->
        <div class="card left" id="cardLeft">ALERT</div>

        <!-- 主体 -->
        <div class="card main">
            <h2 style="color:#2f3640; font-size: 2rem;">MAIN UNIT</h2>
            <div class="btn-group">
                <button class="btn-left" onclick="handleLeft()">Left Slam</button>
                <button class="btn-right" onclick="handleRight()">Right Slam</button>
            </div>
            <p style="color:#7f8c8d; margin-top:20px;">Current View: <span id="stateDisplay">Center</span></p>
        </div>

        <!-- 右侧 -->
        <div class="card right" id="cardRight">
            <div style="font-size: 3rem;">DATA</div>
            <div style="font-size: 1rem; opacity: 0.8; margin-top: 10px;">SECTOR 7-G</div>
        </div>
    </div>

    <script>
        const rig = document.getElementById('cameraRig');
        const cardLeft = document.getElementById('cardLeft');
        const cardRight = document.getElementById('cardRight');
        const stateDisplay = document.getElementById('stateDisplay');

        let currentState = 'none';

        function triggerSlam(el) {
            el.classList.remove('anim-exit');
            void el.offsetWidth;
            el.classList.add('anim-slam');
        }

        function triggerExit(el) {
            el.classList.remove('anim-slam');
            void el.offsetWidth;
            el.classList.add('anim-exit');
        }

        function handleLeft() {
            if (currentState === 'left') {
                triggerExit(cardLeft);
                currentState = 'none';
                stateDisplay.textContent = "Center";
            }
            else if (currentState === 'right') {
                triggerExit(cardRight);
                rig.classList.remove('pan-right');
                setTimeout(() => triggerSlam(cardLeft), 200);
                currentState = 'left';
                stateDisplay.textContent = "Left Active";
            }
            else {
                triggerSlam(cardLeft);
                currentState = 'left';
                stateDisplay.textContent = "Left Active";
            }
        }

        function handleRight() {
            if (currentState === 'right') {
                triggerExit(cardRight);
                rig.classList.remove('pan-right');
                currentState = 'none';
                stateDisplay.textContent = "Center";
            }
            else if (currentState === 'left') {
                triggerExit(cardLeft);
                rig.classList.add('pan-right');
                setTimeout(() => triggerSlam(cardRight), 200);
                currentState = 'right';
                stateDisplay.textContent = "Right Active";
            }
            else {
                rig.classList.add('pan-right');
                setTimeout(() => triggerSlam(cardRight), 200);
                currentState = 'right';
                stateDisplay.textContent = "Right Active";
            }
        }
    </script>
</body>

</html>